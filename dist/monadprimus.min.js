!function(n){var t,r={},u={},e={},i={},o={},f={},c=void 0,a=9007199254740991;function l(n,t){var r;for(r=0;r<n.length;r++)if(n[r]===t)return r;return-1}function s(n,t){var r;for(r in t)t.hasOwnProperty(r)&&(n[r]=t[r])}function h(n,t,r){var u,e,i=new Array(t);for(e=0;e<i.length;e++)i[e]=0;return u=function t(u){return{value:function(){return[].concat(u)},next:function(){var e,i=[].concat(u);for(e=i.length-1;e>=0;)if(i[e]<n){if(i[e]++,r(i))return t(i);e=i.length-1}else i[e--]=0;return null}}}(i),r(i)?u:u.next()}function p(n){return function(t){var r,u;for(r=0;r<t.length;r++)for(u=r+1;u<t.length;u++)if(n(t[r],t[u]))return!1;return!0}}function v(n){var t=o;return function(){return t===o&&(t=n()),t}}function d(n,r){return{at:function(t){if(t<0||t>a)throw new Error("index out of bounds");return t>0?function(n,t){var r;for(r=n;r>0;r--,t=t.rest())if(t.isNull())return c;return t.value()}(t-1,r()):n},value:function(){return n},rest:function(){return r()},bind:function(n){var r=this,u=n(r.value());return u===t?t:new d(u.value(),v(function(){return function u(e){var i,o=e();return o!==t?new d(o.value(),v(function(){return u(o.rest)})):(i=r.rest())!==t?i.bind(n):t}(u.rest)}))},take:function(n){var r,u=[],e=this;for(r=0;(n===c||r<n)&&e!==t;r++)u.push(e.value()),e=e.rest();return u},filter:function(n){return function r(u){var e;for(e=u;e!==t;e=e.rest())if(n(e.value()))return new d(e.value(),v(function(){return r(e.rest())}));return t}(this)},concat:function(n){var r=this;return n===t?r:new d(r.value(),v(function(){return function r(u){var e=u();return e!==t?new d(e.value(),v(function(){return r(e.rest)})):n}(r.rest)}))},map:function(n){var t=this;return new d(n(t.value()),v(function(){return t.rest().map(n)}))},some:function(n){var r;for(r=this;r!==t;r=r.rest())if(n(r.value()))return!0;return!1},every:function(n){return!this.some(function(t){return!n(t)})},isNull:function(n){return n!==c&&0!==n&&this.rest().isNull(n-1)},multiply:function(n){return this.bind(n)}}}function g(n,u,e){var i,o=[],f=e.value();for(i=0;i<u;i++)o.push(n[f[i]]);return d(r.T.apply(null,o),v(function(){var r=e.next();return r?g(n,u,r):t}))}function y(n){return n}t={at:function(n){if(n<0||n>a)throw new Error("index out of bounds");return c},value:function(){return c},rest:function(){return this},bind:function(n){return this},take:function(n){return[]},filter:function(n){return this},concat:function(n){return n===t?this:n},map:function(n){return this},some:function(n){return!1},every:function(n){return!0},isNull:function(n){return!0},multiply:function(n){return this.bind(n)}},r.Nil=t,r.L=function(){var n,r=Array.prototype.slice.call(arguments),u=t;for(n=r.length-1;n>=0;n--)u=function(n,t){return d(r[t],v(function(){return n}))}(u,n);return u},r.L.Nil=t,r.L.unit=function(n){return d(n,function(){return t})},r.L.N=function(n){return function n(t){return d(t,v(function(){return n(t+1)}))}(n)},r.L.Z=function n(t){return d(t,v(function(){return n(t>0?-t:1-t)}))}(0),r.L.range=function(n,r){if(n>r)throw new Error("start must be less than or equal to end");return function n(u){return d(u,v(function(){return u<r?n(u+1):t}))}(n)},r.L.permutation=function(n,t){var r=t===c?n.length:t;if(n.length<r)throw new Error("array size must be less or equal than number");return g(n,r,function(n,t){return h(n,t,p(function(n,t){return n===t}))}(n.length-1,r))},r.L.combination=function(n,t){var r=t===c?n.length:t;if(n.length<r)throw new Error("array size must be less or equal than number");return g(n,r,function(n,t){return h(n,t,p(function(n,t){return n>=t}))}(n.length-1,r))},r.L.product=function(){var n=Array.prototype.slice.call(arguments);return function u(e){var i,o,f,c;n:for(o=e;o;o=o.next()){for(i=[],c=0;c<n.length;c++){if(f=o.value(),n[c].isNull(f[c]))continue n;i.push(n[c].at(f[c]))}return d(r.T.apply(null,i),v(function(){return u(o.setOk().next())}))}return t}(function n(t,r){var u,e=new Array(t),i=new Array(t);for(u=1;u<t;u++)e[u]=i[u]=0;return e[0]=i[0]=r,function u(e,i,o){return{value:function(){return[].concat(e)},next:function(){var f,c=[].concat(e),a=[].concat(i);for(c[c.length-1]=a[c.length-1]=0,f=c.length-2;f>=0;f--){if(c[f]>0)return c[f]--,c[f+1]=a[f+1]=a[f]-c[f],u(c,a,o);c[f]=a[f]=0}return o?n(t,r+1):null},setOk:function(){return u(e,i,!0)}}}(e,i,!1)}(n.length,0))},r.L.power=function(n,t){var u,e=new Array(t);for(u=0;u<t;u++)e[u]=n;return r.L.product.apply(null,e)},r.L.map=function(n){var u,e=Array.prototype.slice.call(arguments,1),i=[],o=[n];if(arguments.length<=1)throw new Error("at least one list required");for(u=0;u<e.length;u++){if(e[u].isNull())return t;i.push(e[u].value()),o.push(e[u].rest())}return new d(n.apply(null,i),v(function(){return r.L.map.apply(null,o)}))},r.L.zip=function(){var n=Array.prototype.slice.call(arguments);return n.unshift(function(){return r.T.apply(null,arguments)}),r.L.map.apply(null,n)},r.L.create=function(n,t){return d(n,v(t))},r.T=function(){var n=Array.prototype.slice.call(arguments);function t(t){return n[t]}return s(t,{toString:function(){var t,r="(";for(t=0;t<n.length;t++)r+=(t>0?",":"")+n[t];return r+")"},toArray:function(){return[].concat(n)},"@tupleId@":u}),t},r.T.isTuple=function(n){return n["@tupleId@"]===u},r.F=function(n,t){var u,o=t===c?n.length:t;function f(t,u){return function(){var e=function(n,t){var u,e,i=[].concat(n);for(u=0;u<t.length;u++)(e=l(n,r.$n(u+1)))<0?i.push(t[u]):i[e]=t[u];return i}(t,arguments);if((e=function(n){var t,u,e=[],o=[].concat(n);for(t=0;t<n.length;t++)if(n[t]["@placeholderId@"]===i)for(u=0;u<=e.length;u++)if(u===e.length||n[t].index()<e[u].place.index()){e.splice(u,0,{orgIndex:t,place:n[t]});break}for(t=0;t<e.length;t++)o[e[t].orgIndex]=r.$n(t+1);return o}(e)).length<o||function(n){var t;for(t=0;t<n.length;t++)if(n[t]["@placeholderId@"]===i)return!0;return!1}(e))return r.F(f(e,u));var c=n.apply(null,e);return u?u(c):c}}return s(u=f([]),{pipe:function(t){if("function"!=typeof t)throw new Error("argument must be a function");if(1!==t.length&&1!==t.argumentsLength())throw new Error("arity of function to compose must be 1");return t===r.F.unit?this:(t["@functionId@"]===e?t.value():t,r.F(f([],t),n.length))},argumentsLength:function(){return o},multiply:function(n){return this.pipe(n)},value:function(){return u},"@functionId@":e}),u},r.$n=function(n){return f[n]===c&&(f[n]=function(n){return{index:function(){return n-1},"@placeholderId@":i}}(n)),f[n]},r.$1=r.$n(1),r.$2=r.$n(2),r.$3=r.$n(3),r.$4=r.$n(4),r.F.unit=function(n){return n},r.F.I=r.F.unit,s(r.F.unit,{pipe:function(n){var t=n["@functionId@"]===e?n:r.F(n);return n===r.F.unit?r.F.unit:t},argumentLength:function(){return 1},multiply:function(n){return this.pipe(n)},value:function(){return y},"@functionId@":e}),r.Identity=function(n){return{bind:function(t){return t(n)},value:function(){return n},toString:function(){return n+""},multiply:function(n){return this.bind(n)}}},r.Identity.unit=function(n){return r.Identity(n)},r.State=function(n){return{bind:function(n){var t=this;return r.State(function(r){var u=t.runState(r);return n(u(0)).runState(u(1))})},runState:function(t){return n(t)},evalState:function(n){return this.runState(n)(0)},execState:function(n){return this.runState(n)(1)},multiply:function(n){return this.bind(n)}}},r.State.unit=function(n){return r.State(function(t){return r.T(n,t)})},r.State.getState=r.State(function(n){return r.T(n,n)}),r.State.putState=function(n){return r.State(function(t){return r.T(c,n)})},r.State.modify=function(n){return r.State(function(t){return r.T(c,n(t))})},r.StateT=function(n){function t(n){return{bind:function(n){var r=this;return t(function(t){return r.runStateT(t).bind(function(t){return n(t(0)).runStateT(t(1))})})},runStateT:function(t){return n(t)},multiply:function(n){return this.bind(n)}}}return t.unit=function(u){return t(function(t){return n.unit(r.T(u,t))})},t.getState=t(function(t){return n.unit(r.T(t,t))}),t.putState=function(u){return t(function(t){return n.unit(r.T(c,u))})},t.modify=function(u){return t(function(t){return n.unit(r.T(c,u(t)))})},t.lift=function(u){return t(function(t){return u.bind(function(u){return n.unit(r.T(u,t))})})},t},r.Just=function(n){return{bind:function(t){return t(n)},value:function(){return n},or:function(n){return this},isNothing:function(){return!1},multiply:function(n){return this.bind(n)},toString:function(){return"Just "+n}}},r.Nothing={bind:function(n){return this},value:function(n){throw new Error("can not get value from Nothing")},or:function(n){return n},isNothing:function(){return!0},multiply:function(n){return this.bind(n)},toString:function(){return"Nothing"}},r.Maybe={},r.Maybe.unit=function(n){return r.Just(n)},r.Right=function(n){return{bind:function(t){return t(n)},either:function(t,r){return r(n)},or:function(n){return this},multiply:function(n){return this.bind(n)},toString:function(){return"Right "+n}}},r.Left=function(n){return{bind:function(n){return this},either:function(t,r){return t(n)},or:function(n){return n},multiply:function(n){return this.bind(n)},toString:function(){return"Left "+n}}},r.Either={},r.Either.unit=function(n){return r.Right(n)},r.tu=r.faites=r.do=function(n){var t,r=n;for(t=1;t<arguments.length;t++)r=r.bind(arguments[t]);return r},"undefined"!=typeof module&&module.exports?module.exports=r:(n.MonadPrimus=n.M=r,n.$L=r.L,n.$T=r.T,n.$F=r.F)}(this);